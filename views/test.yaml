# lovelace_gen

{% set persons = ['Jacob', 'Rikke', 'Cornelie', 'Nathalie', 'Hjalte'] %}

{% set rooms = {
  "Køkken": ["light.kokken", "light.spisebord", "light.maleri", "light.legekokken", "light.kaffebar", "light.kokkeno", "light.kokkenskabe", "light.kokkenbord"]
} %}

{%- macro open_slider(room) -%}
          action: call-service
          service: browser_mod.popup
          service_data:
            title: Indstilling af lys
            style:
              border-radius: 20px
              --ha-card-border-radius: 20px
            card:
              type: entities
              title: {{ room }}
              show_header_toggle: true
              entities:
              {%- for light in rooms[room] %}
                {%- if not loop.first %}
                - type: custom:slider-entity-row
                  entity: {{ light }}
                  #full_row: false
                  toggle: true
                {%- endif %}
              {% endfor %}
            deviceID:
              - this
{%- endmacro %}

title: System
icon: mdi:test-tube
panel: false
cards:

  - !include cards/main/slideshow.yaml

  - type: glance
    title: Køkken
    show_state: false
    columns: 4
    entities:
    {%- for light in rooms["Køkken"] %}
      {%- if not loop.first %}
      - entity: {{ light }}
        tap_action:
          action: toggle
        hold_action:
          {{ open_slider("Køkken") }}
      {%- endif %}  
    {%- endfor %}

  - type: custom:stack-in-card
    mode: horizontal
    cards:
    {% for name in persons %}
      - type: picture-entity
        entity: person.{{ name | lower }}
        image: /local/images/persons/{{ name }}.jpg
        show_name: false
        show_state: false
        state_filter:
          "home": brightness(110%) saturate(1.2)
          "not_home": brightness(50%) hue-rotate(45deg)
    {% endfor %}

  - type: weather-forecast
    entity: weather.smhi_brobyvaerk
    show_forecast: 7 days

  - type: custom:stack-in-card
    mode: horizontal
    title: Brændstofspriser
    cards:
      - type: sensor
        entity: sensor.blyfri_95
        icon: mdi:gas-station
        name: Blyfri 95
        graph: line
        detail: 3

      - type: sensor
        entity: sensor.diesel
        icon: mdi:gas-station
        name: Diesel
        graph: line
        detail: 3

  - type: media-control
    entity: media_player.kokken_skaerm
  - type: media-control
    entity: media_player.stuens_tv