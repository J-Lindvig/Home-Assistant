# lovelace_gen

{% set persons = ['Jacob', 'Rikke', 'Cornelie', 'Nathalie', 'Hjalte'] %}

{% set rooms = {
  "Køkken": ["light.kokken", "light.spisebord", "light.maleri", "light.legekokken", "light.kaffebar", "light.kokkeno", "light.kokkenskabe", "light.kokkenbord"]
} %}

{%- macro ir_command(command) -%}
      service: remote.send_command
      service_data:
        entity_id: remote.rm_mini_3_stuen
        device: Vestel TV
        command: {{ command }}
{%- endmacro %}

{%- macro open_slider(room) -%}
          action: call-service
          service: browser_mod.popup
          service_data:
            title: Indstilling af lys
            style:
              border-radius: 20px
              --ha-card-border-radius: 20px
            card:
              type: entities
              title: {{ room }}
              show_header_toggle: true
              entities:
              {%- for light in rooms[room] %}
                {%- if not loop.first %}
                - type: custom:slider-entity-row
                  entity: {{ light }}
                  #full_row: false
                  toggle: true
                {%- endif %}
              {% endfor %}
            deviceID:
              - this
{%- endmacro %}

title: System
icon: mdi:test-tube
panel: false
cards:

  - !include
    - cards/main/slides/countdown.yaml
    - image_url: "/local/images/backgrounds/bryllup_5x2.png"
      countdown_text: "Bryllupsdag"
      countdown_entity: "sensor.anniversary_bryllupsdag"

  - type: custom:auto-entities
    card:
      type: entities
      title: Transport
      show_header_toggle: false
    filter:
      include:
        - type: section
          label: Busser
        - domain: light
          name: "/Spisebord/"
        - type: section
          label: Toge
        - domain: light
          name: "/Bade/"
    sort:
      method: state
      

  - type: custom:tv-card
    entity: sun.sun
    name: Vestel TV
    tv: false
    power:
      {{ ir_command("Power") }}
    menu:
      {{ ir_command("Menu") }}
    select:
      {{ ir_command("OK") }}
    back:
      {{ ir_command("Back") }}
    up:
      {{ ir_command("Up") }}
    left:
      {{ ir_command("Left") }}
    right:
      {{ ir_command("Right") }}
    down:
      {{ ir_command("Down") }}
    volume_up:
      {{ ir_command("Volume Up") }}
    volume_down:
      {{ ir_command("Volume Down") }}
    volume_mute:
      {{ ir_command("Mute") }}

  - type: custom:rejseplanen-card
    entity: sensor.odense
#    max_entries: 5 # Optional

  - type: custom:gui-sandbox

  - type: glance
    title: Køkken
    show_state: false
    columns: 4
    entities:
    {%- for light in rooms["Køkken"] %}
      {%- if not loop.first %}
      - entity: {{ light }}
        tap_action:
          action: toggle
        hold_action:
          {{ open_slider("Køkken") }}
      {%- endif %}  
    {%- endfor %}

  - type: custom:stack-in-card
    mode: horizontal
    cards:
    {% for name in persons %}
      - type: picture-entity
        entity: person.{{ name | lower }}
        image: /local/images/persons/{{ name }}.jpg
        show_name: false
        show_state: false
        state_filter:
          "home": brightness(110%) saturate(1.2)
          "not_home": brightness(50%) hue-rotate(45deg)
    {% endfor %}

  - type: media-control
    entity: media_player.kokken_skaerm
  - type: media-control
    entity: media_player.stuens_tv